function glm_run()
    tbl = zeros([2865*11, 5+1]);
    for sub=1:11
        label_mat = load(['../data/label/sub', num2str(sub), '.mat']);
        label_mat = label_mat.imageseq;
        task = map_label(label_mat);
        % replace NaN with zero
        task(isnan(task)) = 0;
        tbl(2865*(sub-1)+1:2865*sub, :) = [task, ones([2865, 1])*sub];
    end
	    glme = cell{};
    for ch = 1:126
        channel = zeros([2865*11, 206]);
        fprintf('load data:\n');
        for sub = 1:11
            fprintf(num2str(sub));
            data = load(['../data/preprocessed/sub', num2str(sub), '.mat']);
            data = data.data;
            data = cellfun(@(x)x(ch, :)', data.trial, 'UniformOutput', false);
            channel(2865*(sub-1)+1:2865*sub, :) = horzcat(data{:})';
        end
        for timepoint = 1:206
            fprintf(['\ncalculate channel:', num2str(ch), '\n']);
            dm = array2table([channel(:, timepoint), tbl]);
            glme(ch, timepoint) = fitglme(dm,...
                'Var1 ~ 1 + Var2 + Var3 + Var4 + Var5 + Var6 + (1|Var7)');
        end
    end
    save('glm.mat', glme);
end
